SELECT COUNT(DISTINCT CARDNO) FROM TB_DATA_MASTER DATA_MST
WHERE COMPANY=2
AND FINYEAR=2019
AND FINMONTH='January'
AND PDATE=TO_DATE('01/04/2019','MM/DD/YYYY')
AND OUTTIME >= '09:00:00' AND OUTTIME < '11:00:00'



------------------------------------------------------------


DECLARE
F_YEAR NUMBER:=2019;
F_MONTH VARCHAR2(20):='January';
CURSOR EMP_LIST IS
	   SELECT OUTTIME,SECTIONNM FROM TB_DATA_MASTER
	   WHERE COMPANY=2
	   AND FINYEAR=2019
	   AND FINMONTH='January'
	   AND PDATE=TO_DATE('01/04/2019','MM/DD/YYYY');
C_OUT09TO11 INT:=0;
C_OUT11T015 INT:=0;
C_OUT15TO17 INT:=0;
C_OUT17TO20 INT:=0;
C_OUT20TO23 INT:=0;
OUT_TIME TB_DATA_MASTER.OUTTIME%TYPE;
SECTION_NAME TB_DATA_MASTER.SECTIONNM%TYPE;
BEGIN
OPEN EMP_LIST;
LOOP
	FETCH EMP_LIST INTO OUT_TIME,SECTION_NAME;
	EXIT WHEN EMP_LIST%NOTFOUND;
	IF OUT_TIME >= '09:00:00' AND OUT_TIME < '11:00:00' THEN
	C_OUT09TO11:=C_OUT09TO11+1;
	ELSIF OUT_TIME >= '11:00:00' AND OUT_TIME < '15:00:00' THEN
	C_OUT11T015:=C_OUT11T015+1;
	ELSIF OUT_TIME >= '15:00:00' AND OUT_TIME < '17:00:00' THEN
	C_OUT15TO17:=C_OUT15TO17+1;
	ELSIF OUT_TIME >= '17:00:00' AND OUT_TIME < '20:00:00' THEN
	C_OUT17TO20:=C_OUT17TO20+1;
	ELSIF OUT_TIME >= '20:00:00' AND OUT_TIME < '23:59:59' THEN
	C_OUT20TO23:=C_OUT20TO23+1;
	END IF;
END LOOP;
DBMS_OUTPUT.PUT_LINE('OUT TIME BETWEEN 09 TO 11: '||C_OUT09TO11 || SECTION_NAME);
DBMS_OUTPUT.PUT_LINE('OUT TIME BETWEEN 11 TO 15: '||C_OUT11T015);
DBMS_OUTPUT.PUT_LINE('OUT TIME BETWEEN 15 TO 17: '||C_OUT15TO17);
DBMS_OUTPUT.PUT_LINE('OUT TIME BETWEEN 17 TO 20: '||C_OUT17TO20);
DBMS_OUTPUT.PUT_LINE('OUT TIME BETWEEN 20 TO 23: '||C_OUT20TO23);
CLOSE EMP_LIST;
END;
	

	
	
